From e34416bcc9f4c76cac926627accd62861d3b4b1c Mon Sep 17 00:00:00 2001
From: "Luis Gustavo S. Barreto" <gustavo@ossystems.com.br>
Date: Fri, 22 May 2020 15:45:49 -0300
Subject: [PATCH] agent: fix primaryIface method to skip non-critical errors
Organization: O.S. Systems Software LTDA.

Upstream-Status: Accepted [1]

[1] https://github.com/shellhub-io/shellhub/commit/e34416bcc9f4c76cac926627accd62861d3b4b1c

---
 agent/identity.go | 10 +++++-----
 1 file changed, 5 insertions(+), 5 deletions(-)

diff --git a/agent/identity.go b/agent/identity.go
index a1b5186..6821159 100644
--- a/agent/identity.go
+++ b/agent/identity.go
@@ -64,26 +64,26 @@ func primaryIface() (*net.Interface, error) {
 
 		data, err := readSysFs(iface.Name, "type")
 		if err != nil {
-			break
+			continue
 		}
 
 		iftype, err := strconv.ParseUint(data, 10, 16)
 		if err != nil {
-			break
+			continue
 		}
 
 		if iftype != syscall.ARPHRD_ETHER {
-			break
+			continue
 		}
 
 		data, err = readSysFs(iface.Name, "ifindex")
 		if err != nil {
-			break
+			continue
 		}
 
 		ifindex, err := strconv.ParseUint(data, 10, 16)
 		if err != nil {
-			break
+			continue
 		}
 
 		if ifindex < min {
-- 
2.26.2

